/* =========================================================
   696 GAME — PVP CARD ANIMATIONS
   (container animations live on .bb-slot)
   ---------------------------------------------------------
   WHY .bb-slot:
   - In page.tsx animation state classes (is-spawn / is-attack-*) are applied to .bb-slot
   - .bb-card already uses its own animation (flipIn) and 3D transforms; we avoid conflicts
   RULES:
   - CardArt is NOT animated directly
   - Only transforms/opacity (no layout: no left/top)
   ========================================================= */

/* Base safety */
.bb-slot {
    will-change: transform, opacity;
    transform-origin: 50% 70%;
  }
  
  /* ---------------------------------------------------------
     STEP 1 — SPAWN (Hearthstone-like, clean)
     Triggered by: .bb-slot.is-spawn
  --------------------------------------------------------- */
  
  .bb-slot.is-spawn {
    animation: bb-slot-spawn 420ms cubic-bezier(0.22, 1, 0.36, 1) both;
  }
  
  @keyframes bb-slot-spawn {
    0% {
      opacity: 0;
      transform: translate3d(0, 18px, 0) scale(0.94);
    }
    55% {
      opacity: 1;
      transform: translate3d(0, -2px, 0) scale(1.04);
    }
    100% {
      opacity: 1;
      transform: translate3d(0, 0, 0) scale(1);
    }
  }
  
  /* Spawn FX layer (already used by .bb-spawn in JSX) */
  .bb-slot.is-spawn .bb-spawn {
    animation: bb-spawn-flash 260ms ease-out both;
  }
  
  @keyframes bb-spawn-flash {
    0% {
      opacity: 0;
      box-shadow:
        inset 0 0 0 9999px rgba(255,255,255,0.08),
        0 0 0 rgba(255,255,255,0);
    }
    40% {
      opacity: 1;
      box-shadow:
        inset 0 0 0 9999px rgba(255,255,255,0.05),
        0 0 24px rgba(120,240,255,0.25);
    }
    100% {
      opacity: 0;
      box-shadow:
        inset 0 0 0 9999px rgba(255,255,255,0),
        0 0 0 rgba(255,255,255,0);
    }
  }
  
  /* ---------------------------------------------------------
     STEP 3 — ATTACK LUNGE (Hearthstone-like)
     Triggered by:
       .bb-slot.is-attack-from  : attacker lunge
       .bb-slot.is-attack-to    : defender micro-impact
  --------------------------------------------------------- */
  
  .bb-slot.is-attack-from {
    animation: bb-slot-lunge 160ms cubic-bezier(0.34, 1.56, 0.64, 1) both;
  }
  
  .bb-slot.is-attack-to {
    animation: bb-slot-impact 140ms ease-out both;
  }
  
  @keyframes bb-slot-lunge {
    0%   { transform: translate3d(0, 0, 0) scale(1); }
    65%  { transform: translate3d(0, -10px, 0) scale(1.06); }
    100% { transform: translate3d(0, 0, 0) scale(1); }
  }
  
  @keyframes bb-slot-impact {
    0%   { transform: scale(1); }
    45%  { transform: scale(0.965); }
    100% { transform: scale(1); }
  }

/* ---------------------------------------------------------
   STEP 4A — DEATH V2 (Collapse + Ash) — NO ASSETS
   Goal: readable "death" (freeze → collapse → ash) not just fade
   Trigger: .bb-slot.is-dying
--------------------------------------------------------- */

/* Make sure FX overlays can sit correctly without affecting layout */
.bb-slot { position: relative; }

.bb-slot.is-dying {
  animation: bb-death-collapse 560ms cubic-bezier(0.22, 1, 0.36, 1) both;
  transform-origin: 50% 80%;
}

/* Freeze internal flip/hover transitions during death to avoid fighting transforms */
.bb-slot.is-dying .bb-card-inner {
  transition: none !important;
  filter: grayscale(0.35) saturate(0.65) contrast(1.05);
}

/* Ash overlay using existing .bb-death layer (placeholder FX, still looks "gamey") */
.bb-slot.is-dying .bb-death {
  pointer-events: none;
  opacity: 0;
  animation: bb-ash-burst 560ms ease-out both;
  background:
    radial-gradient(closest-side, rgba(255,255,255,0.18), rgba(255,255,255,0) 65%),
    radial-gradient(closest-side, rgba(160,220,255,0.12), rgba(160,220,255,0) 70%);
  mix-blend-mode: screen;
}

@keyframes bb-death-collapse {
  0%   { opacity: 1; transform: translate3d(0,0,0) rotate(0deg) scale3d(1,1,1); }
  18%  { opacity: 1; transform: translate3d(0,0,0) rotate(0deg) scale3d(0.985,0.99,1); }
  52%  { opacity: 0.98; transform: translate3d(0,10px,0) rotate(7deg) scale3d(0.96,0.88,1); }
  78%  { opacity: 0.7; transform: translate3d(0,22px,0) rotate(11deg) scale3d(0.86,0.62,1); }
  100% { opacity: 0; transform: translate3d(0,34px,0) rotate(14deg) scale3d(0.74,0.40,1); }
}

@keyframes bb-ash-burst {
  0%   { opacity: 0; transform: scale(0.85); filter: blur(0px); }
  20%  { opacity: 0.55; transform: scale(1.05); filter: blur(0px); }
  55%  { opacity: 0.28; transform: scale(1.22); filter: blur(0.6px); }
  100% { opacity: 0; transform: scale(1.32); filter: blur(1px); }
}
