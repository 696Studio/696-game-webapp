/* =========================================================
   696 GAME — PVP CARD ANIMATIONS
   (container animations live on .bb-slot)
   ---------------------------------------------------------
   WHY .bb-slot:
   - In page.tsx animation state classes (is-spawn / is-attack-*) are applied to .bb-slot
   - .bb-card already uses its own animation (flipIn) and 3D transforms; we avoid conflicts
   RULES:
   - CardArt is NOT animated directly
   - Only transforms/opacity (no layout: no left/top)
   ========================================================= */

/* Base safety */
.bb-slot {
    will-change: transform, opacity;
    transform-origin: 50% 70%;
  }
  
  /* ---------------------------------------------------------
     STEP 1 — SPAWN (Hearthstone-like, clean)
     Triggered by: .bb-slot.is-spawn
  --------------------------------------------------------- */
  
  .bb-slot.is-spawn {
    animation: bb-slot-spawn 420ms cubic-bezier(0.22, 1, 0.36, 1) both;
  }
  
  @keyframes bb-slot-spawn {
    0% {
      opacity: 0;
      transform: translate3d(0, 18px, 0) scale(0.94);
    }
    55% {
      opacity: 1;
      transform: translate3d(0, -2px, 0) scale(1.04);
    }
    100% {
      opacity: 1;
      transform: translate3d(0, 0, 0) scale(1);
    }
  }
  
  /* Spawn FX layer (already used by .bb-spawn in JSX) */
  .bb-slot.is-spawn .bb-spawn {
    animation: bb-spawn-flash 260ms ease-out both;
  }
  
  @keyframes bb-spawn-flash {
    0% {
      opacity: 0;
      box-shadow:
        inset 0 0 0 9999px rgba(255,255,255,0.08),
        0 0 0 rgba(255,255,255,0);
    }
    40% {
      opacity: 1;
      box-shadow:
        inset 0 0 0 9999px rgba(255,255,255,0.05),
        0 0 24px rgba(120,240,255,0.25);
    }
    100% {
      opacity: 0;
      box-shadow:
        inset 0 0 0 9999px rgba(255,255,255,0),
        0 0 0 rgba(255,255,255,0);
    }
  }
  
  /* ---------------------------------------------------------
     STEP 3 — ATTACK LUNGE (Hearthstone-like)
     Triggered by:
       .bb-slot.is-attack-from  : attacker lunge
       .bb-slot.is-attack-to    : defender micro-impact
  --------------------------------------------------------- */
  
  .bb-slot.is-attack-from {
    animation: bb-slot-lunge 160ms cubic-bezier(0.34, 1.56, 0.64, 1) both;
  }
  
  .bb-slot.is-attack-to {
    animation: bb-slot-impact 140ms ease-out both;
  }
  
  @keyframes bb-slot-lunge {
    0%   { transform: translate3d(0, 0, 0) scale(1); }
    65%  { transform: translate3d(0, -10px, 0) scale(1.06); }
    100% { transform: translate3d(0, 0, 0) scale(1); }
  }
  
  @keyframes bb-slot-impact {
    0%   { transform: scale(1); }
    45%  { transform: scale(0.965); }
    100% { transform: scale(1); }
  }

/* ---------------------------------------------------------
   STEP 4 — DEATH (freeze → tilt → fade)
   Triggered by: .bb-slot.is-dying  (from death events window)
--------------------------------------------------------- */
.bb-slot.is-dying {
  animation: bb-slot-death 520ms cubic-bezier(0.22, 1, 0.36, 1) both;
  transform-origin: 50% 75%;
}

/* Subtle "freeze" feel: stop other motions inside during death */
.bb-slot.is-dying .bb-card-inner {
  transition: none !important;
}

@keyframes bb-slot-death {
  0%   { opacity: 1; transform: translate3d(0, 0, 0) rotate(0deg) scale(1); }
  18%  { opacity: 1; transform: translate3d(0, 0, 0) rotate(0deg) scale(1); }
  55%  { opacity: 0.95; transform: translate3d(0, 6px, 0) rotate(6deg) scale(0.985); }
  100% { opacity: 0; transform: translate3d(0, 22px, 0) rotate(10deg) scale(0.96); }
}

/* "Skeleton pop" placeholder: quick pulse on existing .bb-death layer */
.bb-slot.is-dying .bb-death {
  animation: bb-skel-pop 520ms ease-out both;
  opacity: 1;
}

@keyframes bb-skel-pop {
  0%   { opacity: 0; transform: scale(0.85); }
  25%  { opacity: 0.55; transform: scale(1.05); }
  60%  { opacity: 0.28; transform: scale(1.18); }
  100% { opacity: 0; transform: scale(1.28); }
}
